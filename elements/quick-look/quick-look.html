<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../bower_components/marked-element/marked-element.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../../bower_components/neon-animation/animations/slide-from-left-animation.html">
<link rel="import" href="../../bower_components/neon-animation/animations/fade-out-animation.html">
<link rel="import" href="../../bower_components/neon-animation/web-animations.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<link href="https://fonts.googleapis.com/css?family=Montserrat:100" rel="stylesheet">

<dom-module id="quick-look">

    <template>
        <style>
             :host {
                display: block;
                font-family: 'Montserrat', sans-serif;
                font-weight: 100;
            }

            nav {
                display: flex;     
                flex-direction: row;
                justify-content: space-between;                                     
                width: 100%;
                list-style: none;
                margin: 0;
                padding: 0;
            }

            nav a {        
                display: block;
                flex: 1 0 auto;
                float: left;
                text-align: center; 
                font-size: 2vw;
                text-decoration: none;
                color: #839496;                        
                border-color: #839496;
                border-width: 0.1vw;
                border-style: solid;
                padding: 0.4vw 0;
                margin: 0 0.4vw;
                transition: 1s;
            }

            nav a:hover {
                background-color: #839496;
                color: rgba(0, 43, 54, 1);
                transition: 1s;
            }
                
            paper-material {
                display: block;
                position: absolute;
                bottom: 2vh;
                padding: 1em;
                background-color: #fdf6e3;
                color: #657b83;
            }

        </style>

        <neon-animated-pages selected="{{selected}}" attr-for-selected="route" entry-animation="slide-from-left-animation" exit-animation="fade-out-animation">
            <div route="none"></div>
            <template is="dom-repeat" items="[[pages]]">
                <div route=[[item.route]]>
                <paper-material route=[[item.route]] elevation="1">
                    <marked-element>
                        <div class="markdown-html"></div>
                        <script type="text/markdown" src="/[[directory]]/[[item.markdown]]"></script>
                    </marked-element>
                </paper-material>
                </div>
            </template>
        </neon-animated-pages>

        <nav>
            <template is="dom-repeat" items="[[pages]]">
                <a on-mouseover="show" on-mouseleave="hide" route="[[item.route]]" href="[[item.route]]">[[item.title]]</a>
            </template>
        </nav>

        <iron-ajax
             auto
             url="/[[directory]]/pages.json"
             handle-as="json"
             last-response="{{pages}}">
        </iron-ajax>
        
    </template>

    <script>
        class QuickLook extends Polymer.Element {
            static get is() { return "quick-look"; }

            // configure the owner property
            static get properties() {
                return {
                    directory: {
                        type: String,
                    },
                    pages: {
                        type: Object,
                    },
                    selected: {
                        type: String,
                        value: "0",
                    }
                };
            }

        show(source){
            clearTimeout(this.timeout);
            this.selected = source.target.route;
        }

        hide(){
            var self = this;
            this.timeout = setTimeout(function(){
                self.selected = "none";            
            },500);
        }

        }
        customElements.define(QuickLook.is, QuickLook);
    </script>

</dom-module>